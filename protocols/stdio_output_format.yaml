# Strigoi STDIO Output Format
# Simple, parseable, complete

output_format:
  version: "1.0.0"
  principle: "Test everything discoverable, report totality"
  
metadata_header:
  format: |
    === STRIGOI TEST REPORT ===
    Protocol: {protocol_name} v{protocol_version}
    Target: {target_ip}:{port}
    Date: {iso8601_timestamp}
    Duration: {elapsed_seconds}s
    Strigoi: v{strigoi_version} (build {build_hash})
    Signed: {signature_hash}
    ===========================
    
test_results:
  format: |
    {feature}:{test}:{result}:{interpretation}
  
  fields:
    feature: "tools/list"              # What we're testing
    test: "rate_limit_enforcement"     # Specific test from ontology
    result: "PASS|FAIL|BLOCKED|ERROR"  # Raw outcome
    interpretation: "String message"    # What it means
    
  examples:
    - "tools/list:rate_limit_enforcement:PASS:Properly rejects after 10 requests"
    - "tools/list:internal_exposure_check:FAIL:Exposes admin_debug_console tool"
    - "tools/call:injection_resistance:BLOCKED:White-hat constraints prevent testing"
    - "resources/read:path_traversal_prevention:FAIL:Allows ../../etc/passwd access"

totality_section:
  format: |
    
    === COVERAGE TOTALITY ===
    Discovered: {total_features}
    Tested: {tested_count} ({tested_percentage}%)
    Not Tested: {not_tested_count} ({not_tested_percentage}%)
    
    NOT TESTED:
    {feature}:SKIPPED:{reason}
    
  examples:
    - "prompts/run:SKIPPED:WHITE_HAT_RESTRICTED"
    - "resources/write:SKIPPED:WHITE_HAT_RESTRICTED"
    - "server/configure:SKIPPED:AUTHENTICATION_REQUIRED"
    - "internal/debug:SKIPPED:NOT_ENUMERABLE"

summary_footer:
  format: |
    
    === RISK SUMMARY ===
    Critical Findings: {critical_count}
    High Risk: {high_count}
    Medium Risk: {medium_count}
    Low Risk: {low_count}
    
    Overall Risk Score: {calculated_score}/100
    Recommendation: {BLOCK|MONITOR|ALLOW}
    =======================

# Complete example output
example_output: |
  === STRIGOI TEST REPORT ===
  Protocol: Model Context Protocol v2025-03-26
  Target: 192.168.1.50:8080
  Date: 2025-01-25T14:32:10Z
  Duration: 47.3s
  Strigoi: v1.0.0 (build a7f3e9b2)
  Signed: sha256:1a2b3c4d5e6f...
  ===========================
  
  tools/list:rate_limit_enforcement:PASS:Properly rejects after 10 requests
  tools/list:internal_exposure_check:FAIL:Exposes admin_debug_console tool
  tools/list:pagination_consistency:PASS:Cursor behavior is predictable
  tools/list:response_time_analysis:PASS:No timing attack vectors detected
  
  prompts/list:rate_limit_enforcement:PASS:Properly rejects after 5 requests
  prompts/list:injection_detection:FAIL:Found SQL injection in prompt template
  prompts/list:credential_detection:FAIL:Prompt asks for API keys
  prompts/list:prompt_length_check:PASS:All prompts under 10KB limit
  
  resources/list:rate_limit_enforcement:PASS:Properly rejects after 5 requests
  resources/list:enumeration_boundary:PASS:No system files exposed
  resources/list:response_time_analysis:PASS:Consistent response times
  
  resources/read:path_traversal_prevention:FAIL:Allows ../../etc/passwd access
  resources/read:authorization_validation:ERROR:No auth mechanism detected
  resources/read:injection_resistance:PASS:URI validation prevents injection
  resources/read:data_leakage_assessment:FAIL:Exposed database credentials
  
  tools/call:injection_resistance:BLOCKED:White-hat constraints prevent testing
  tools/call:schema_validation:PASS:Enforces parameter types correctly
  
  === COVERAGE TOTALITY ===
  Discovered: 24
  Tested: 5 (20.8%)
  Not Tested: 19 (79.2%)
  
  NOT TESTED:
  prompts/run:SKIPPED:WHITE_HAT_RESTRICTED
  completion/create:SKIPPED:WHITE_HAT_RESTRICTED
  resources/write:SKIPPED:WHITE_HAT_RESTRICTED
  resources/delete:SKIPPED:WHITE_HAT_RESTRICTED
  prompts/create:SKIPPED:WHITE_HAT_RESTRICTED
  server/configure:SKIPPED:AUTHENTICATION_REQUIRED
  auth/setup:SKIPPED:AUTHENTICATION_REQUIRED
  logging/get:SKIPPED:AUTHENTICATION_REQUIRED
  tools/execute:SKIPPED:NOT_ENUMERABLE
  debug/trace:SKIPPED:NOT_ENUMERABLE
  admin/users:SKIPPED:NOT_ENUMERABLE
  internal/metrics:SKIPPED:NOT_ENUMERABLE
  system/health:SKIPPED:RATE_LIMITED
  batch/process:SKIPPED:DEPENDENCY_MISSING
  websocket/connect:SKIPPED:PROTOCOL_UNSUPPORTED
  graphql/query:SKIPPED:ENDPOINT_NOT_FOUND
  custom/vendor1:SKIPPED:VENDOR_SPECIFIC
  custom/vendor2:SKIPPED:VENDOR_SPECIFIC
  beta/feature:SKIPPED:VERSION_MISMATCH
  
  === RISK SUMMARY ===
  Critical Findings: 2
  High Risk: 3
  Medium Risk: 1
  Low Risk: 0
  
  Overall Risk Score: 76/100
  Recommendation: BLOCK
  =======================

parsing_notes:
  - "Colon-delimited for easy cut/awk/grep"
  - "Fixed format for each line type"
  - "Machine parseable, human readable"
  - "Complete totality always included"
  - "No assumptions about risk priority"