# MCP Test Totality Example
# What Strigoi v1.0.0 can and cannot test

protocol:
  name: "Model Context Protocol"
  version: "2025-03-26"
  test_date: "2025-01-25"
  
agent_manifold:
  identity:
    name: "Strigoi"
    version: "1.0.0-beta.1"
    build: "a7f3e9b2"
    
  signature:
    signed_by: "strigoi-test-authority@macawi.ai"
    key_id: "0xDEADBEEF"
    hash: "sha256:3b4c8a9f..."
    
  constraints:
    - "WHITE_HAT_ONLY"
    - "NO_DESTRUCTIVE_TESTS"
    - "RESPECT_RATE_LIMITS"

test_universe:
  discovered_features: 24
  
  categorized:
    ENUMERATION:
      - tools/list         # ✓ TESTED
      - prompts/list       # ✓ TESTED
      - resources/list     # ✓ TESTED
      
    DATA_ACCESS:
      - resources/read     # ✓ TESTED
      - resources/get      # ⚠ PARTIALLY TESTED
      - logging/get        # ✗ NOT TESTED (auth required)
      
    EXECUTION:
      - tools/call         # ⚠ PARTIALLY TESTED
      - prompts/run        # ✗ NOT TESTED (risk too high)
      - completion/create  # ✗ NOT TESTED (risk too high)
      
    STATE_MODIFICATION:
      - resources/write    # ✗ NOT TESTED (white hat restricted)
      - resources/delete   # ✗ NOT TESTED (white hat restricted)
      - prompts/create     # ✗ NOT TESTED (white hat restricted)
      
    CONFIGURATION:
      - server/configure   # ✗ NOT TESTED (requires admin)
      - auth/setup        # ✗ NOT TESTED (requires admin)

coverage_report:
  
  tested_features: 4
    tools/list:
      tests_performed: 8
      findings: 1
      risk_score: 15
      evidence_hash: "sha256:1a2b3c..."
      
    prompts/list:
      tests_performed: 10
      findings: 3
      risk_score: 35
      evidence_hash: "sha256:4d5e6f..."
      
    resources/list:
      tests_performed: 7
      findings: 0
      risk_score: 10
      evidence_hash: "sha256:7a8b9c..."
      
    resources/read:
      tests_performed: 12
      findings: 2
      risk_score: 55
      evidence_hash: "sha256:1d2e3f..."
  
  partially_tested_features: 2
    resources/get:
      coverage: 40%
      tested:
        - "Basic parameter validation"
        - "Error response format"
      not_tested:
        - "Large file handling"
        - "Binary content types"
        - "Concurrent access"
      reason: "Time constraints"
      
    tools/call:
      coverage: 20%
      tested:
        - "Schema validation"
        - "Safe tool execution (echo only)"
      not_tested:
        - "Dangerous tool blocking"
        - "Resource exhaustion"
        - "Injection resistance"
      reason: "White hat restrictions"
  
  not_tested_features: 14
    prompts/run:
      reason: "RISK_TOO_HIGH"
      risk_assessment: "CRITICAL"
      explanation: "Could execute arbitrary AI prompts"
      recommendation: "Manual review with sandbox"
      
    resources/write:
      reason: "WHITE_HAT_RESTRICTED"
      risk_assessment: "HIGH"
      explanation: "Would modify server state"
      recommendation: "Test in isolated environment"
      
    logging/get:
      reason: "AUTHENTICATION_REQUIRED"
      risk_assessment: "UNKNOWN"
      explanation: "Requires valid session token"
      recommendation: "Retest with credentials"
      
    server/configure:
      reason: "DEPENDENCY_MISSING"
      risk_assessment: "CRITICAL"
      explanation: "Requires admin role"
      recommendation: "Coordinate with system owner"

totality_summary:
  coverage_percentage: 25.0  # (4 + 0.4 + 0.2) / 24
  
  by_risk_level:
    tested:
      CRITICAL: 0
      HIGH: 1
      MEDIUM: 2
      LOW: 1
      
    not_tested:
      CRITICAL: 6
      HIGH: 4
      MEDIUM: 2
      LOW: 0
      UNKNOWN: 2
      
  gaps_analysis:
    critical_untested:
      - "All EXECUTION class features untested"
      - "No STATE_MODIFICATION testing possible"
      - "CONFIGURATION completely blocked"
      
    risk_implications:
      - "Server may allow arbitrary code execution"
      - "State modifications lack validation"
      - "Configuration endpoints unassessed"

recommendations:
  immediate:
    - "Obtain test credentials for auth-protected endpoints"
    - "Set up isolated test environment for destructive tests"
    - "Coordinate with Prismatic for admin access"
    
  future:
    - "Develop sandbox for EXECUTION class testing"
    - "Create rollback mechanism for STATE tests"
    - "Build fuzzing framework for deeper coverage"

# Output parameter examples
output_modes:
  
  # Default: Everything
  full_report:
    tested: YES
    not_tested: YES
    partially_tested: YES
    evidence: SANITIZED
    
  # For executives
  summary_only:
    tested: COUNT_ONLY
    not_tested: COUNT_ONLY
    partially_tested: COUNT_ONLY
    evidence: NONE
    
  # For developers
  gaps_focus:
    tested: NO
    not_tested: YES
    partially_tested: YES
    evidence: RECOMMENDATIONS
    
  # For compliance
  evidence_trail:
    tested: YES
    not_tested: NO
    partially_tested: NO
    evidence: FULL