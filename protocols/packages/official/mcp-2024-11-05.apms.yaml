# Model Context Protocol (MCP) - Strigoi Protocol Package
# Generated from NelaPark Protocol Pipeline
# Version: 2024-11-05

header:
  protocol_identity:
    name: "Model Context Protocol"
    version: "2024-11-05"
    uuid: "mcp-2024-11-05-strigoi-pkg"
    family: "agent-context"
  
  strigoi_metadata:
    package_type: "official"
    package_version: "1.0.0"
    last_updated: "2025-01-25T00:00:00Z"
    compatibility: "strigoi-0.1.0+"
    
  security_assessment:
    test_coverage: 85.5
    vulnerability_count: 12
    critical_findings: 3
    last_assessment: "2025-01-25T00:00:00Z"

payload:
  
  # Test Module Definitions
  test_modules:
    
    # Discovery Modules
    - module_id: "mcp/discovery/tools_list"
      module_type: "discovery"
      risk_level: "low"
      test_vectors:
        - vector: "enumerate_exposed_tools"
          severity_checks:
            - pattern: "exec|shell|command"
              severity: "critical"
            - pattern: "write|delete|modify"
              severity: "high"
            - pattern: "read|list|query"
              severity: "medium"
      
    - module_id: "mcp/discovery/prompts_list"
      module_type: "discovery"
      risk_level: "low"
      test_vectors:
        - vector: "prompt_injection_detection"
          injection_patterns:
            - "command execution"
            - "code execution"
            - "file system access"
            - "data extraction"
    
    - module_id: "mcp/discovery/resources_list"
      module_type: "discovery"
      risk_level: "low"
      test_vectors:
        - vector: "sensitive_resource_exposure"
          sensitive_patterns:
            - category: "credentials"
              patterns: ["password", "token", "key", "secret"]
              severity: "critical"
            - category: "database"
              patterns: ["db", "sql", "backup"]
              severity: "high"
            - category: "pii"
              patterns: ["user", "customer", "email", "phone"]
              severity: "medium"
    
    # Attack Modules
    - module_id: "mcp/auth/bypass"
      module_type: "attack"
      risk_level: "medium"
      test_vectors:
        - vector: "no_auth_required"
          description: "Test if authentication is enforced"
        - vector: "empty_token"
          description: "Test with empty authentication"
        - vector: "default_credentials"
          description: "Test common default credentials"
        - vector: "jwt_none_algorithm"
          description: "Test JWT 'none' algorithm bypass"
        - vector: "auth_header_injection"
          description: "Test authentication header injection"
    
    - module_id: "mcp/dos/rate_limit"
      module_type: "stress"
      risk_level: "high"
      test_vectors:
        - vector: "no_rate_limiting"
          parameters:
            threads: 10
            duration: 5
            requests_per_second_threshold: 100
        - vector: "response_degradation"
          parameters:
            max_response_time_threshold: 5000
    
    # Advanced Attack Modules (Future)
    - module_id: "mcp/injection/prompt_manipulation"
      module_type: "attack"
      risk_level: "high"
      status: "planned"
      test_vectors:
        - vector: "system_prompt_override"
        - vector: "context_injection"
        - vector: "tool_confusion"
    
    - module_id: "mcp/state/memory_corruption"
      module_type: "attack"
      risk_level: "critical"
      status: "planned"
      test_vectors:
        - vector: "context_overflow"
        - vector: "state_confusion"
        - vector: "memory_exhaustion"
  
  # Protocol-Specific Intelligence
  protocol_intelligence:
    
    known_implementations:
      - name: "Claude Desktop"
        vendor: "Anthropic"
        specific_tests:
          - "claude_specific_prompts"
          - "desktop_integration_vectors"
      
      - name: "Cody"
        vendor: "Sourcegraph"
        specific_tests:
          - "code_context_manipulation"
          - "repository_access_patterns"
    
    common_vulnerabilities:
      - cve: "STRIGOI-MCP-001"
        description: "Unrestricted tool enumeration exposes dangerous capabilities"
        affected_versions: "all"
        severity: "high"
      
      - cve: "STRIGOI-MCP-002"
        description: "Missing rate limiting on JSON-RPC endpoints"
        affected_versions: "all"
        severity: "medium"
      
      - cve: "STRIGOI-MCP-003"
        description: "Prompt injection through unvalidated user input"
        affected_versions: "all"
        severity: "critical"
    
    attack_chains:
      - chain_id: "mcp_takeover_001"
        name: "Complete MCP Server Compromise"
        steps:
          - "Enumerate tools via tools/list"
          - "Identify dangerous tools (exec, write)"
          - "Bypass authentication if present"
          - "Execute commands via exposed tools"
        complexity: "medium"
        impact: "critical"
  
  # Update Mechanism
  update_configuration:
    update_source: "http://localhost:8888/protocols/mcp"
    update_frequency: "weekly"
    signature_verification: true
    rollback_supported: true
    
    scheduled_updates:
      - date: "2025-02-01T00:00:00Z"
        changes:
          - "New prompt injection patterns"
          - "Updated tool danger classifications"
          - "Additional authentication bypass techniques"

# Distribution metadata
distribution:
  channels:
    - "official"
    - "strigoi-core"
  
  dependencies:
    - "core-framework >= 0.1.0"
    - "json-rpc-client >= 1.0.0"
  
  verification:
    checksum: "sha256:abcdef123456..."
    signature: "gpg:strigoi-signing-key"